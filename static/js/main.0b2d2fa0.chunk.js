(this.webpackJsonpinterests=this.webpackJsonpinterests||[]).push([[0],{133:function(e,t,n){"use strict";n.r(t);var c,r=n(3),a=n.n(r),i=n(65),s=n.n(i),u=(n(82),n(4)),o=n(0),b=n.n(o),l=n(1),d=n(14),j=Object(r.createContext)([{status:"out",webId:""},function(){}]),O=n(5),f=n(37),p=n(2),h=function(e){var t,n=e.onLogin,c=Object(f.a)(e,["onLogin"]),a=Object(r.useState)(!1),i=Object(u.a)(a,2),s=i[0],o=i[1],b=Object(r.useState)(null!==(t=localStorage.getItem("idp"))&&void 0!==t?t:"https://solidcommunity.net"),l=Object(u.a)(b,2),d=l[0],j=l[1];return s?Object(p.jsxs)("div",{className:"card",children:[Object(p.jsx)("header",{className:"card-header",children:Object(p.jsx)("p",{className:"card-header-title",children:"Select your Solid identity provider"})}),Object(p.jsx)("div",{className:"card-content",children:Object(p.jsxs)("form",{onSubmit:function(e){e.preventDefault(),localStorage.setItem("idp",d),n(d)},children:[Object(p.jsx)("div",{className:"field",children:Object(p.jsx)("div",{className:"control",children:Object(p.jsx)("input",{id:"idp",className:"input",type:"url",value:d,onChange:function(e){e.preventDefault();var t=e.currentTarget.value;j(t)},placeholder:"Where is your Solid Pod?"})})}),Object(p.jsx)("div",{className:"field",children:Object(p.jsx)("div",{className:"control",children:Object(p.jsx)("input",{type:"submit",value:"Connect",className:"button is-link"})})})]})})]}):Object(p.jsx)("button",Object(O.a)(Object(O.a)({},c),{},{className:"button",onClick:function(e){e.preventDefault(),o(!0)},children:"Login"}))},v=function(){var e=Object(r.useContext)(j),t=Object(u.a)(e,2),n=t[0],c=t[1];Object(r.useEffect)((function(){Object(l.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(d.handleIncomingRedirect)();case 3:(n=e.sent)&&n.isLoggedIn?c({status:"in",webId:null!==(t=null===n||void 0===n?void 0:n.webId)&&void 0!==t?t:""}):c({status:"out",webId:""}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),alert("error signing in"+e.t0.message),c({status:"out",webId:""});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()}),[c]);var a=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,r,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c({status:"pending",webId:""}),e.prev=1,e.next=4,Object(d.login)({oidcIssuer:t,clientName:"Solid Interests"});case 4:r=Object(d.getDefaultSession)(),a=r.info,c({status:"in",webId:null!==(n=null===a||void 0===a?void 0:a.webId)&&void 0!==n?n:""}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0.message),c({status:"out",webId:""});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Object(l.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c((function(e){return{webId:e.webId,status:"pending"}})),e.prev=1,e.next=4,Object(d.logout)();case 4:c({status:"out",webId:""}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),alert(e.t0.message),c((function(e){return{webId:e.webId,status:"in"}}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();return"pending"===n.status?Object(p.jsx)(p.Fragment,{children:"Loading"}):"in"===n.status?Object(p.jsx)("button",{className:"button",onClick:i,children:"Log out"}):Object(p.jsx)(h,{onLogin:a})},m=n(26),x=n(73),g=n(6),w=function(e){var t=e.webId,n=e.onChangeUser,c=Object(r.useState)(t),a=Object(u.a)(c,2),i=a[0],s=a[1],o=function(){var e=Object(l.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n(i);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("form",{onSubmit:o,children:[Object(p.jsx)("input",{className:"input",type:"text",value:i,onChange:function(e){return s(e.target.value)}}),Object(p.jsx)("button",{className:"button",type:"button",onClick:function(){return s(t)},children:"my webId"})]})})},I=n(9),k=n(67),N=n(69),y=n(43),C=n.n(y),S=n(12),F=n(15),L=/^https?:\/\/(w{3}\.)?wikidata\.org\/entity\/([A-Z0-9]*)\/?$/,A=function(){for(var e,t,n=arguments.length,c=new Array(n),r=0;r<n;r++)c[r]=arguments[r];var a=c[0],i=c[1],s=c.slice(2),u=Object(O.a)({accept:"text/turtle"},null!==(e=null===i||void 0===i?void 0:i.headers)&&void 0!==e?e:{}),o=Object(O.a)(Object(O.a)({},i),{},{headers:u});return(t=window).fetch.apply(t,[a,o].concat(Object(S.a)(s)))},D=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,c,r,a,i,s,u,o,l,d,j;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null!==(n=null===(c=t.match(L))||void 0===c?void 0:c[2])&&void 0!==n?n:"",a=r?"https://www.wikidata.org/wiki/Special:EntityData/".concat(r,".ttl"):t,e.next=4,Object(I.b)(a,{fetch:A});case 4:if(i=e.sent,!(s=Object(I.e)(i,t))){e.next=10;break}return d=null!==(u=Object(I.c)(s,F.b.label,"en"))&&void 0!==u?u:"",j=null!==(o=null!==(l=Object(I.c)(s,F.c.description,"en"))&&void 0!==l?l:Object(I.c)(s,F.b.comment,"en"))&&void 0!==o?o:"",e.abrupt("return",{uri:t,label:d,description:j});case 10:return e.abrupt("return",{uri:t,label:"",description:""});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=new AbortController,P=function(e,t){return function(){var n=Object(l.a)(b.a.mark((function n(c){var r,a;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(E.abort(),E=new AbortController,0!==c.length){n.next=4;break}return n.abrupt("return",[]);case 4:return n.prev=4,n.next=7,fetch(e(c),{signal:E.signal});case 7:return r=n.sent,n.next=10,r.json();case 10:return a=n.sent,n.abrupt("return",t(a));case 14:if(n.prev=14,n.t0=n.catch(4),"AbortError"!==n.t0.name){n.next=18;break}return n.abrupt("return");case 18:throw n.t0;case 19:case"end":return n.stop()}}),n,null,[[4,14]])})));return function(e){return n.apply(this,arguments)}}()},U=P((function(e){return"https://www.wikidata.org/w/api.php?action=wbsearchentities&search=".concat(encodeURIComponent(e),"&format=json&errorformat=plaintext&language=en&uselang=en&type=item&origin=*")}),(function(e){return e.search.map((function(e){return{uri:e.concepturi,description:e.description,label:e.label}}))})),R=P((function(e){return"https://lookup.dbpedia.org/api/prefix?query=".concat(encodeURIComponent(e),"&format=json$")}),(function(e){return e.docs.map((function(e){return{uri:Object(u.a)(e.resource,1)[0],description:"...",label:Object(u.a)(e.label,1)[0]}}))})),T=C()(U,30),_=C()(R,30),B=function(e){var t=e.onSelectInterest,n=Object(r.useState)(""),c=Object(u.a)(n,2),a=c[0],i=c[1],s=Object(r.useState)([]),o=Object(u.a)(s,2),d=o[0],j=o[1],O=Object(r.useState)("wd"),f=Object(u.a)(O,2),h=f[0],v=f[1];Object(r.useEffect)((function(){Object(l.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,("wd"===h?T:_)(a);case 2:(t=e.sent)&&j(t);case 4:case"end":return e.stop()}}),e)})))()}),[a,h]);return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("input",{type:"text",className:"input",placeholder:"add interest",value:a,onChange:function(e){return i(e.target.value)}}),Object(p.jsx)("button",{className:"button",onClick:function(){v((function(e){return"wd"===e?"dbp":"wd"}))},children:"wd"===h?"wikidata":"dbpedia"}),Object(p.jsx)("ul",{children:d.map((function(e){return Object(p.jsxs)("li",{onClick:function(){return function(e){i(""),t(e)}(e)},children:[e.label,": ",e.description]},e.uri)}))})]})},J=function(e){var t=e.interest,n=e.onClose;return Object(p.jsxs)("div",{className:"tags has-addons",children:[Object(p.jsx)("a",{title:t.description,className:"tag is-link".concat(t.pending?" is-light":""),href:t.uri,children:t.label}),Object(p.jsx)("button",{disabled:!!t.pending,onClick:function(){return n()},className:"tag is-delete"})]})},$=N.a.img(c||(c=Object(k.a)(["\n  && {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n"]))),q=function(e){var t=e.user,n=e.loggedUserId,c=e.onAddInterest,r=e.onRemoveInterest,a=Object.values(t.interests);return Object(p.jsx)("div",{className:"card",children:Object(p.jsxs)("div",{className:"card-content",children:[Object(p.jsxs)("div",{className:"media",children:[Object(p.jsx)("div",{className:"media-left",children:Object(p.jsx)("figure",{className:"image is-48x48",children:t.photo&&Object(p.jsx)($,{src:t.photo,alt:"Photo of ".concat(t.name)})})}),Object(p.jsxs)("div",{className:"media-content",children:[Object(p.jsx)("p",{className:"title is-4",children:t.name}),Object(p.jsx)("p",{className:"subtitle is-6",children:Object(p.jsx)("a",{href:t.webId,children:t.webId})})]})]}),Object(p.jsxs)("div",{className:"content",children:[a.length>0?Object(p.jsx)("div",{className:"field is-grouped is-grouped-multiline",children:a.map((function(e){return Object(p.jsx)("div",{className:"control",children:Object(p.jsx)(J,{interest:e,onClose:function(){return r(e)}})},e.uri)}))}):"no interests",n===t.webId&&Object(p.jsx)(B,{onSelectInterest:c})]})]})})},M=function(e){var t=e.webId,n=Object(r.useState)(t),c=Object(u.a)(n,2),a=c[0],i=c[1],s=Object(r.useState)({webId:"",name:"",photo:"",interests:{}}),o=Object(u.a)(s,2),j=o[0],h=o[1],v=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,c,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(j.interests).includes(t.uri)){e.next=14;break}return h((function(e){return Object(O.a)(Object(O.a)({},e),{},{interests:Object(O.a)(Object(O.a)({},e.interests),Object(g.a)({},t.uri,Object(O.a)(Object(O.a)({},t),{},{pending:!0})))})})),e.next=4,Object(I.b)(a,{fetch:d.fetch});case 4:if(n=e.sent,!(c=Object(I.e)(n,a))){e.next=11;break}return r=Object(I.a)(c,F.a.topic_interest,t.uri),i=Object(I.i)(n,r),e.next=11,Object(I.h)(a,i,{fetch:d.fetch});case 11:h((function(e){return Object(O.a)(Object(O.a)({},e),{},{interests:Object(O.a)(Object(O.a)({},e.interests),Object(g.a)({},t.uri,Object(O.a)({},t)))})})),e.next=15;break;case 14:alert("".concat(t.label," already added"));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,c,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h((function(e){return Object(O.a)(Object(O.a)({},e),{},{interests:Object(O.a)(Object(O.a)({},e.interests),Object(g.a)({},t.uri,Object(O.a)(Object(O.a)({},t),{},{pending:!0})))})})),e.next=3,Object(I.b)(a,{fetch:d.fetch});case 3:if(n=e.sent,!(c=Object(I.e)(n,a))){e.next=10;break}return r=Object(I.g)(c,F.a.topic_interest,t.uri),i=Object(I.i)(n,r),e.next=10,Object(I.h)(a,i,{fetch:d.fetch});case 10:h((function(e){var n=e.interests,c=t.uri,r=(n[c],Object(f.a)(n,[c].map(x.a)));return Object(O.a)(Object(O.a)({},e),{},{interests:r})}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){h({webId:"",name:"",photo:"",interests:{}}),Object(l.a)(b.a.mark((function e(){var t,n,c,r,i,s,u,o,l,j,f,p,v,x,w;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.b)(a,{fetch:d.fetch});case 2:if(t=e.sent,n=Object(I.e)(t,a)){l=null!==(c=null===(r=Object(I.d)(n,F.a.name))||void 0===r?void 0:r.value)&&void 0!==c?c:"",j=null!==(i=null!==(s=null===(u=Object(I.d)(n,F.a.img))||void 0===u?void 0:u.value)&&void 0!==s?s:null===(o=Object(I.d)(n,F.d.hasPhoto))||void 0===o?void 0:o.value)&&void 0!==i?i:"",f=Object(I.f)(n,F.a.topic_interest),p=Object.fromEntries(f.map((function(e){return[e,{uri:e,label:"...",description:"",pending:!0}]}))),h({name:l,photo:j,webId:a,interests:p}),v=Object(m.a)(f);try{for(v.s();!(x=v.n()).done;)w=x.value,D(w).then((function(e){return h((function(t){return Object(O.a)(Object(O.a)({},t),{},{interests:Object(O.a)(Object(O.a)({},t.interests),Object(g.a)({},e.uri,Object(O.a)({},e)))})}))}))}catch(b){v.e(b)}finally{v.f()}}case 5:case"end":return e.stop()}}),e)})))()}),[a,t]),Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(w,{webId:t,onChangeUser:function(e){i(e)}}),j.webId?Object(p.jsx)(q,{onAddInterest:v,onRemoveInterest:k,user:j,loggedUserId:t}):"loading profile..."]})};var W=function(){var e=Object(r.useContext)(j),t=Object(u.a)(e,1)[0];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(v,{}),"in"===t.status&&Object(p.jsx)(M,{webId:t.webId})]})},Z=function(e){e&&e instanceof Function&&n.e(5).then(n.bind(null,158)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))},z=function(e){var t=e.children,n=Object(r.useState)({status:"pending",webId:""}),c=Object(u.a)(n,2),a=c[0],i=c[1];return Object(p.jsx)(j.Provider,{value:[a,i],children:t})};s.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(z,{children:Object(p.jsx)(W,{})})}),document.getElementById("root")),Z()},82:function(e,t,n){}},[[133,1,2]]]);
//# sourceMappingURL=main.0b2d2fa0.chunk.js.map