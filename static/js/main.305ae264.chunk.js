(this.webpackJsonpinterests=this.webpackJsonpinterests||[]).push([[0],{138:function(e,t,n){"use strict";n.r(t);var r,c=n(3),a=n.n(c),i=n(71),s=n.n(i),u=(n(87),n(4)),o=n(0),b=n.n(o),l=n(1),d=n(19),j=Object(c.createContext)([{status:"out",webId:""},function(){}]),p=n(5),f=n(42),O=n(2),h=function(e){var t,n=e.onLogin,r=Object(f.a)(e,["onLogin"]),a=Object(c.useState)(!1),i=Object(u.a)(a,2),s=i[0],o=i[1],b=Object(c.useState)(null!==(t=localStorage.getItem("idp"))&&void 0!==t?t:"https://solidcommunity.net"),l=Object(u.a)(b,2),d=l[0],j=l[1];return s?Object(O.jsxs)("div",{className:"card",children:[Object(O.jsx)("header",{className:"card-header",children:Object(O.jsx)("p",{className:"card-header-title",children:"Select your Solid identity provider"})}),Object(O.jsx)("div",{className:"card-content",children:Object(O.jsxs)("form",{onSubmit:function(e){e.preventDefault(),localStorage.setItem("idp",d),n(d)},children:[Object(O.jsx)("div",{className:"field",children:Object(O.jsx)("div",{className:"control",children:Object(O.jsx)("input",{id:"idp",className:"input",type:"url",value:d,onChange:function(e){e.preventDefault();var t=e.currentTarget.value;j(t)},placeholder:"Where is your Solid Pod?"})})}),Object(O.jsx)("div",{className:"field",children:Object(O.jsx)("div",{className:"control",children:Object(O.jsx)("input",{type:"submit",value:"Connect",className:"button is-link"})})})]})})]}):Object(O.jsx)("button",Object(p.a)(Object(p.a)({},r),{},{className:"button",onClick:function(e){e.preventDefault(),o(!0)},children:"Login"}))},v=function(){var e=Object(c.useContext)(j),t=Object(u.a)(e,2),n=t[0],r=t[1];Object(c.useEffect)((function(){Object(l.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(d.handleIncomingRedirect)();case 3:(n=e.sent)&&n.isLoggedIn?r({status:"in",webId:null!==(t=null===n||void 0===n?void 0:n.webId)&&void 0!==t?t:""}):r({status:"out",webId:""}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),alert("error signing in"+e.t0.message),r({status:"out",webId:""});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()}),[r]);var a=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,c,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({status:"pending",webId:""}),e.prev=1,e.next=4,Object(d.login)({oidcIssuer:t,clientName:"Solid Interests"});case 4:c=Object(d.getDefaultSession)(),a=c.info,r({status:"in",webId:null!==(n=null===a||void 0===a?void 0:a.webId)&&void 0!==n?n:""}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0.message),r({status:"out",webId:""});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),i=function(){var e=Object(l.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((function(e){return{webId:e.webId,status:"pending"}})),e.prev=1,e.next=4,Object(d.logout)();case 4:r({status:"out",webId:""}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),alert(e.t0.message),r((function(e){return{webId:e.webId,status:"in"}}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();return"pending"===n.status?Object(O.jsx)(O.Fragment,{children:"Loading"}):"in"===n.status?Object(O.jsx)("button",{className:"button",onClick:i,children:"Log out"}):Object(O.jsx)(h,{onLogin:a})},m=n(28),x=n(80),g=n(6),w=function(e){var t=e.webId,n=e.onChangeUser,r=Object(c.useState)(t),a=Object(u.a)(r,2),i=a[0],s=a[1],o=function(){var e=Object(l.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n(i);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(O.jsx)(O.Fragment,{children:Object(O.jsxs)("form",{onSubmit:o,children:[Object(O.jsx)("input",{className:"input",type:"text",value:i,onChange:function(e){return s(e.target.value)}}),Object(O.jsx)("button",{className:"button",type:"button",onClick:function(){return s(t)},children:"my webId"})]})})},I=n(13),k=n(73),y=n(75),N=n(48),C=n.n(N),S=n(12),L=n(20),F=n(139),A=/^https?:\/\/(w{3}\.)?wikidata\.org\/entity\/([A-Z0-9]*)\/?$/,D=function(){for(var e,t,n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];var a=r[0],i=r[1],s=r.slice(2),u=Object(p.a)({accept:"text/turtle"},null!==(e=null===i||void 0===i?void 0:i.headers)&&void 0!==e?e:{});return(t=window).fetch.apply(t,[a,Object(p.a)(Object(p.a)({},i),{},{headers:u})].concat(Object(S.a)(s)))},E=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,r,c,a,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=null!==(n=null===(r=t.match(A))||void 0===r?void 0:r[2])&&void 0!==n?n:"",a=c?"https://www.wikidata.org/wiki/Special:EntityData/".concat(c,".ttl"):t,e.next=4,D(a);case 4:return e.next=6,e.sent.text();case 6:return i=e.sent,e.next=9,B(i,t);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=new AbortController,U=function(e,t){return function(){var n=Object(l.a)(b.a.mark((function n(r){var c,a;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(P.abort(),P=new AbortController,0!==r.length){n.next=4;break}return n.abrupt("return",[]);case 4:return n.prev=4,n.next=7,window.fetch(e(r),{signal:P.signal});case 7:return c=n.sent,n.next=10,c.json();case 10:return a=n.sent,n.abrupt("return",t(a));case 14:if(n.prev=14,n.t0=n.catch(4),"AbortError"!==n.t0.name){n.next=18;break}return n.abrupt("return");case 18:throw n.t0;case 19:case"end":return n.stop()}}),n,null,[[4,14]])})));return function(e){return n.apply(this,arguments)}}()},R=U((function(e){return"https://www.wikidata.org/w/api.php?action=wbsearchentities&search=".concat(encodeURIComponent(e),"&format=json&errorformat=plaintext&language=en&uselang=en&type=item&origin=*")}),(function(e){return e.search.map((function(e){return{uri:e.concepturi,description:e.description,label:e.label}}))})),T=U((function(e){return"https://lookup.dbpedia.org/api/prefix?query=".concat(encodeURIComponent(e),"&format=json$")}),(function(e){return e.docs.map((function(e){return{uri:Object(u.a)(e.resource,1)[0],description:"...",label:Object(u.a)(e.label,1)[0]}}))})),_=new F.a,B=function(){var e=Object(l.a)(b.a.mark((function e(t,n){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={uri:n,description:"",label:""},e.abrupt("return",new Promise((function(e,c){_.parse(t,(function(t,a,i){return t?c(t):a?void(a.subject.id===n&&(a.predicate.id===L.b.label&&"Literal"===a.object.termType&&"en"===a.object.language&&(r.label=a.object.value),a.predicate.id!==L.c.description&&a.predicate.id!==L.b.comment||"Literal"!==a.object.termType||"en"!==a.object.language||(r.description=a.object.value))):e(r)}))})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),J=C()(R,30),$=C()(T,30),q=function(e){var t=e.onSelectInterest,n=Object(c.useState)(""),r=Object(u.a)(n,2),a=r[0],i=r[1],s=Object(c.useState)([]),o=Object(u.a)(s,2),d=o[0],j=o[1],p=Object(c.useState)("wd"),f=Object(u.a)(p,2),h=f[0],v=f[1];Object(c.useEffect)((function(){Object(l.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,("wd"===h?J:$)(a);case 2:(t=e.sent)&&j(t);case 4:case"end":return e.stop()}}),e)})))()}),[a,h]);return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("input",{type:"text",className:"input",placeholder:"add interest",value:a,onChange:function(e){return i(e.target.value)}}),Object(O.jsx)("button",{className:"button",onClick:function(){v((function(e){return"wd"===e?"dbp":"wd"}))},children:"wd"===h?"wikidata":"dbpedia"}),Object(O.jsx)("ul",{children:d.map((function(e){return Object(O.jsxs)("li",{onClick:function(){return function(e){i(""),t(e)}(e)},children:[e.label,": ",e.description]},e.uri)}))})]})},M=function(e){var t=e.interest,n=e.onClose;return Object(O.jsxs)("div",{className:"tags has-addons",children:[Object(O.jsx)("a",{title:t.description,className:"tag is-link".concat(t.pending?" is-light":""),href:t.uri,children:t.label}),Object(O.jsx)("button",{disabled:!!t.pending,onClick:function(){return n()},className:"tag is-delete"})]})},W=y.a.img(r||(r=Object(k.a)(["\n  && {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n"]))),Z=function(e){var t=e.user,n=e.loggedUserId,r=e.onAddInterest,c=e.onRemoveInterest,a=Object.values(t.interests);return Object(O.jsx)("div",{className:"card",children:Object(O.jsxs)("div",{className:"card-content",children:[Object(O.jsxs)("div",{className:"media",children:[Object(O.jsx)("div",{className:"media-left",children:Object(O.jsx)("figure",{className:"image is-48x48",children:t.photo&&Object(O.jsx)(W,{src:t.photo,alt:"Photo of ".concat(t.name)})})}),Object(O.jsxs)("div",{className:"media-content",children:[Object(O.jsx)("p",{className:"title is-4",children:t.name}),Object(O.jsx)("p",{className:"subtitle is-6",children:Object(O.jsx)("a",{href:t.webId,children:t.webId})})]})]}),Object(O.jsxs)("div",{className:"content",children:[a.length>0?Object(O.jsx)("div",{className:"field is-grouped is-grouped-multiline",children:a.map((function(e){return Object(O.jsx)("div",{className:"control",children:Object(O.jsx)(M,{interest:e,onClose:function(){return c(e)}})},e.uri)}))}):"no interests",n===t.webId&&Object(O.jsx)(q,{onSelectInterest:r})]})]})})},z=function(e){var t=e.webId,n=Object(c.useState)(t),r=Object(u.a)(n,2),a=r[0],i=r[1],s=Object(c.useState)({webId:"",name:"",photo:"",interests:{}}),o=Object(u.a)(s,2),j=o[0],h=o[1],v=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,r,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(j.interests).includes(t.uri)){e.next=14;break}return h((function(e){return Object(p.a)(Object(p.a)({},e),{},{interests:Object(p.a)(Object(p.a)({},e.interests),Object(g.a)({},t.uri,Object(p.a)(Object(p.a)({},t),{},{pending:!0})))})})),e.next=4,Object(I.b)(a,{fetch:d.fetch});case 4:if(n=e.sent,!(r=Object(I.d)(n,a))){e.next=11;break}return c=Object(I.a)(r,L.a.topic_interest,t.uri),i=Object(I.h)(n,c),e.next=11,Object(I.g)(a,i,{fetch:d.fetch});case 11:h((function(e){return Object(p.a)(Object(p.a)({},e),{},{interests:Object(p.a)(Object(p.a)({},e.interests),Object(g.a)({},t.uri,Object(p.a)({},t)))})})),e.next=15;break;case 14:alert("".concat(t.label," already added"));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,r,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h((function(e){return Object(p.a)(Object(p.a)({},e),{},{interests:Object(p.a)(Object(p.a)({},e.interests),Object(g.a)({},t.uri,Object(p.a)(Object(p.a)({},t),{},{pending:!0})))})})),e.next=3,Object(I.b)(a,{fetch:d.fetch});case 3:if(n=e.sent,!(r=Object(I.d)(n,a))){e.next=10;break}return c=Object(I.f)(r,L.a.topic_interest,t.uri),i=Object(I.h)(n,c),e.next=10,Object(I.g)(a,i,{fetch:d.fetch});case 10:h((function(e){var n=e.interests,r=t.uri,c=(n[r],Object(f.a)(n,[r].map(x.a)));return Object(p.a)(Object(p.a)({},e),{},{interests:c})}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){h({webId:"",name:"",photo:"",interests:{}}),Object(l.a)(b.a.mark((function e(){var t,n,r,c,i,s,u,o,l,j,f,O,v,x,w;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.b)(a,{fetch:d.fetch});case 2:if(t=e.sent,n=Object(I.d)(t,a)){l=null!==(r=null===(c=Object(I.c)(n,L.a.name))||void 0===c?void 0:c.value)&&void 0!==r?r:"",j=null!==(i=null!==(s=null===(u=Object(I.c)(n,L.a.img))||void 0===u?void 0:u.value)&&void 0!==s?s:null===(o=Object(I.c)(n,L.d.hasPhoto))||void 0===o?void 0:o.value)&&void 0!==i?i:"",f=Object(I.e)(n,L.a.topic_interest),O=Object.fromEntries(f.map((function(e){return[e,{uri:e,label:"...",description:"",pending:!0}]}))),h({name:l,photo:j,webId:a,interests:O}),v=Object(m.a)(f);try{for(v.s();!(x=v.n()).done;)w=x.value,E(w).then((function(e){return h((function(t){return Object(p.a)(Object(p.a)({},t),{},{interests:Object(p.a)(Object(p.a)({},t.interests),Object(g.a)({},e.uri,Object(p.a)({},e)))})}))}))}catch(b){v.e(b)}finally{v.f()}}case 5:case"end":return e.stop()}}),e)})))()}),[a,t]),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(w,{webId:t,onChangeUser:function(e){i(e)}}),j.webId?Object(O.jsx)(Z,{onAddInterest:v,onRemoveInterest:k,user:j,loggedUserId:t}):"loading profile..."]})};var G=function(){var e=Object(c.useContext)(j),t=Object(u.a)(e,1)[0];return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(v,{}),"in"===t.status&&Object(O.jsx)(z,{webId:t.webId})]})},H=function(e){e&&e instanceof Function&&n.e(5).then(n.bind(null,162)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),c(e),a(e),i(e)}))},K=function(e){var t=e.children,n=Object(c.useState)({status:"pending",webId:""}),r=Object(u.a)(n,2),a=r[0],i=r[1];return Object(O.jsx)(j.Provider,{value:[a,i],children:t})};s.a.render(Object(O.jsx)(a.a.StrictMode,{children:Object(O.jsx)(K,{children:Object(O.jsx)(G,{})})}),document.getElementById("root")),H()},87:function(e,t,n){}},[[138,1,2]]]);
//# sourceMappingURL=main.305ae264.chunk.js.map