(this.webpackJsonpinterests=this.webpackJsonpinterests||[]).push([[0],{133:function(e,t,n){"use strict";n.r(t);var r,c=n(3),a=n.n(c),s=n(64),i=n.n(s),u=(n(82),n(4)),o=n(0),b=n.n(o),l=n(1),d=n(14),j=Object(c.createContext)([{status:"out",webId:""},function(){}]),f=n(2),O=function(){var e=Object(c.useContext)(j),t=Object(u.a)(e,2),n=t[0],r=t[1];Object(c.useEffect)((function(){Object(l.a)(b.a.mark((function e(){var t,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(d.handleIncomingRedirect)();case 3:(n=e.sent)&&n.isLoggedIn?r({status:"in",webId:null!==(t=null===n||void 0===n?void 0:n.webId)&&void 0!==t?t:""}):r({status:"out",webId:""}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),alert("error signing in"+e.t0.message),r({status:"out",webId:""});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))()}),[r]);var a=function(){var e=Object(l.a)(b.a.mark((function e(){var t,n,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r({status:"pending",webId:""}),e.prev=1,e.next=4,Object(d.login)({oidcIssuer:"https://solidcommunity.net",clientName:"Solid Interests"});case 4:n=Object(d.getDefaultSession)(),c=n.info,r({status:"in",webId:null!==(t=null===c||void 0===c?void 0:c.webId)&&void 0!==t?t:""}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),alert(e.t0.message),r({status:"out",webId:""});case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(l.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r((function(e){return{webId:e.webId,status:"pending"}})),e.prev=1,e.next=4,Object(d.logout)();case 4:r({status:"out",webId:""}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),alert(e.t0.message),r((function(e){return{webId:e.webId,status:"in"}}));case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}();return"pending"===n.status?Object(f.jsx)(f.Fragment,{children:"Loading"}):"in"===n.status?Object(f.jsx)("button",{className:"button",onClick:s,children:"Log out"}):Object(f.jsx)("button",{className:"button",onClick:a,children:"Log in"})},p=n(26),h=n(72),v=n(73),x=n(5),m=n(7),w=function(e){var t=e.webId,n=e.onChangeUser,r=Object(c.useState)(t),a=Object(u.a)(r,2),s=a[0],i=a[1],o=function(){var e=Object(l.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),n(s);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsx)(f.Fragment,{children:Object(f.jsxs)("form",{onSubmit:o,children:[Object(f.jsx)("input",{className:"input",type:"text",value:s,onChange:function(e){return i(e.target.value)}}),Object(f.jsx)("button",{className:"button",type:"button",onClick:function(){return i(t)},children:"my webId"})]})})},g=n(9),I=n(66),k=n(68),y=n(42),C=n.n(y),N=n(12),S=n(15),F=/^https?:\/\/(w{3}\.)?wikidata\.org\/entity\/([A-Z0-9]*)\/?$/,A=function(){for(var e,t,n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];var a=r[0],s=r[1],i=r.slice(2),u=Object(m.a)({accept:"text/turtle"},null!==(e=null===s||void 0===s?void 0:s.headers)&&void 0!==e?e:{}),o=Object(m.a)(Object(m.a)({},s),{},{headers:u});return(t=window).fetch.apply(t,[a,o].concat(Object(N.a)(i)))},E=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,r,c,a,s,i,u,o,l,d,j;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=null!==(n=null===(r=t.match(F))||void 0===r?void 0:r[2])&&void 0!==n?n:"",a=c?"https://www.wikidata.org/wiki/Special:EntityData/".concat(c,".ttl"):t,e.next=4,Object(g.b)(a,{fetch:A});case 4:if(s=e.sent,!(i=Object(g.e)(s,t))){e.next=10;break}return d=null!==(u=Object(g.c)(i,S.b.label,"en"))&&void 0!==u?u:"",j=null!==(o=null!==(l=Object(g.c)(i,S.c.description,"en"))&&void 0!==l?l:Object(g.c)(i,S.b.comment,"en"))&&void 0!==o?o:"",e.abrupt("return",{uri:t,label:d,description:j});case 10:return e.abrupt("return",{uri:t,label:"",description:""});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=new AbortController,U=function(e,t){return function(){var n=Object(l.a)(b.a.mark((function n(r){var c,a;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(L.abort(),L=new AbortController,0!==r.length){n.next=4;break}return n.abrupt("return",[]);case 4:return n.prev=4,n.next=7,fetch(e(r),{signal:L.signal});case 7:return c=n.sent,n.next=10,c.json();case 10:return a=n.sent,n.abrupt("return",t(a));case 14:if(n.prev=14,n.t0=n.catch(4),"AbortError"!==n.t0.name){n.next=18;break}return n.abrupt("return");case 18:throw n.t0;case 19:case"end":return n.stop()}}),n,null,[[4,14]])})));return function(e){return n.apply(this,arguments)}}()},P=U((function(e){return"https://www.wikidata.org/w/api.php?action=wbsearchentities&search=".concat(encodeURIComponent(e),"&format=json&errorformat=plaintext&language=en&uselang=en&type=item&origin=*")}),(function(e){return e.search.map((function(e){return{uri:e.concepturi,description:e.description,label:e.label}}))})),R=U((function(e){return"https://lookup.dbpedia.org/api/prefix?query=".concat(encodeURIComponent(e),"&format=json$")}),(function(e){return e.docs.map((function(e){return{uri:Object(u.a)(e.resource,1)[0],description:"...",label:Object(u.a)(e.label,1)[0]}}))})),D=C()(P,30),_=C()(R,30),B=function(e){var t=e.onSelectInterest,n=Object(c.useState)(""),r=Object(u.a)(n,2),a=r[0],s=r[1],i=Object(c.useState)([]),o=Object(u.a)(i,2),d=o[0],j=o[1],O=Object(c.useState)("wd"),p=Object(u.a)(O,2),h=p[0],v=p[1];Object(c.useEffect)((function(){Object(l.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,("wd"===h?D:_)(a);case 2:(t=e.sent)&&j(t);case 4:case"end":return e.stop()}}),e)})))()}),[a,h]);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("input",{type:"text",className:"input",placeholder:"add interest",value:a,onChange:function(e){return s(e.target.value)}}),Object(f.jsx)("button",{className:"button",onClick:function(){v((function(e){return"wd"===e?"dbp":"wd"}))},children:"wd"===h?"wikidata":"dbpedia"}),Object(f.jsx)("ul",{children:d.map((function(e){return Object(f.jsxs)("li",{onClick:function(){return function(e){s(""),t(e)}(e)},children:[e.label,": ",e.description]},e.uri)}))})]})},J=function(e){var t=e.interest,n=e.onClose;return Object(f.jsxs)("div",{className:"tags has-addons",children:[Object(f.jsx)("a",{title:t.description,className:"tag is-link".concat(t.pending?" is-light":""),href:t.uri,children:t.label}),Object(f.jsx)("button",{disabled:!!t.pending,onClick:function(){return n()},className:"tag is-delete"})]})},T=k.a.img(r||(r=Object(I.a)(["\n  && {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n"]))),$=function(e){var t=e.user,n=e.loggedUserId,r=e.onAddInterest,c=e.onRemoveInterest,a=Object.values(t.interests);return Object(f.jsx)("div",{className:"card",children:Object(f.jsxs)("div",{className:"card-content",children:[Object(f.jsxs)("div",{className:"media",children:[Object(f.jsx)("div",{className:"media-left",children:Object(f.jsx)("figure",{className:"image is-48x48",children:t.photo&&Object(f.jsx)(T,{src:t.photo,alt:"Photo of ".concat(t.name)})})}),Object(f.jsxs)("div",{className:"media-content",children:[Object(f.jsx)("p",{className:"title is-4",children:t.name}),Object(f.jsx)("p",{className:"subtitle is-6",children:Object(f.jsx)("a",{href:t.webId,children:t.webId})})]})]}),Object(f.jsxs)("div",{className:"content",children:[a.length>0?Object(f.jsx)("div",{className:"field is-grouped is-grouped-multiline",children:a.map((function(e){return Object(f.jsx)("div",{className:"control",children:Object(f.jsx)(J,{interest:e,onClose:function(){return c(e)}})},e.uri)}))}):"no interests",n===t.webId&&Object(f.jsx)(B,{onSelectInterest:r})]})]})})},q=function(e){var t=e.webId,n=Object(c.useState)(t),r=Object(u.a)(n,2),a=r[0],s=r[1],i=Object(c.useState)({webId:"",name:"",photo:"",interests:{}}),o=Object(u.a)(i,2),j=o[0],O=o[1],I=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,r,c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object.keys(j.interests).includes(t.uri)){e.next=14;break}return O((function(e){return Object(m.a)(Object(m.a)({},e),{},{interests:Object(m.a)(Object(m.a)({},e.interests),Object(x.a)({},t.uri,Object(m.a)(Object(m.a)({},t),{},{pending:!0})))})})),e.next=4,Object(g.b)(a,{fetch:d.fetch});case 4:if(n=e.sent,!(r=Object(g.e)(n,a))){e.next=11;break}return c=Object(g.a)(r,S.a.topic_interest,t.uri),s=Object(g.i)(n,c),e.next=11,Object(g.h)(a,s,{fetch:d.fetch});case 11:O((function(e){return Object(m.a)(Object(m.a)({},e),{},{interests:Object(m.a)(Object(m.a)({},e.interests),Object(x.a)({},t.uri,Object(m.a)({},t)))})})),e.next=15;break;case 14:alert("".concat(t.label," already added"));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(l.a)(b.a.mark((function e(t){var n,r,c,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O((function(e){return Object(m.a)(Object(m.a)({},e),{},{interests:Object(m.a)(Object(m.a)({},e.interests),Object(x.a)({},t.uri,Object(m.a)(Object(m.a)({},t),{},{pending:!0})))})})),e.next=3,Object(g.b)(a,{fetch:d.fetch});case 3:if(n=e.sent,!(r=Object(g.e)(n,a))){e.next=10;break}return c=Object(g.g)(r,S.a.topic_interest,t.uri),s=Object(g.i)(n,c),e.next=10,Object(g.h)(a,s,{fetch:d.fetch});case 10:O((function(e){var n=e.interests,r=t.uri,c=(n[r],Object(h.a)(n,[r].map(v.a)));return Object(m.a)(Object(m.a)({},e),{},{interests:c})}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){O({webId:"",name:"",photo:"",interests:{}}),Object(l.a)(b.a.mark((function e(){var t,n,r,c,s,i,u,o,l,j,f,h,v,w,I;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.b)(a,{fetch:d.fetch});case 2:if(t=e.sent,n=Object(g.e)(t,a)){l=null!==(r=null===(c=Object(g.d)(n,S.a.name))||void 0===c?void 0:c.value)&&void 0!==r?r:"",j=null!==(s=null!==(i=null===(u=Object(g.d)(n,S.a.img))||void 0===u?void 0:u.value)&&void 0!==i?i:null===(o=Object(g.d)(n,S.d.hasPhoto))||void 0===o?void 0:o.value)&&void 0!==s?s:"",f=Object(g.f)(n,S.a.topic_interest),h=Object.fromEntries(f.map((function(e){return[e,{uri:e,label:"...",description:"",pending:!0}]}))),O({name:l,photo:j,webId:a,interests:h}),v=Object(p.a)(f);try{for(v.s();!(w=v.n()).done;)I=w.value,E(I).then((function(e){return O((function(t){return Object(m.a)(Object(m.a)({},t),{},{interests:Object(m.a)(Object(m.a)({},t.interests),Object(x.a)({},e.uri,Object(m.a)({},e)))})}))}))}catch(b){v.e(b)}finally{v.f()}}case 5:case"end":return e.stop()}}),e)})))()}),[a,t]),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(w,{webId:t,onChangeUser:function(e){s(e)}}),j.webId?Object(f.jsx)($,{onAddInterest:I,onRemoveInterest:k,user:j,loggedUserId:t}):"loading profile..."]})};var M=function(){var e=Object(c.useContext)(j),t=Object(u.a)(e,1)[0];return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(O,{}),"in"===t.status&&Object(f.jsx)(q,{webId:t.webId})]})},Z=function(e){e&&e instanceof Function&&n.e(5).then(n.bind(null,158)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))},z=function(e){var t=e.children,n=Object(c.useState)({status:"pending",webId:""}),r=Object(u.a)(n,2),a=r[0],s=r[1];return Object(f.jsx)(j.Provider,{value:[a,s],children:t})};i.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(z,{children:Object(f.jsx)(M,{})})}),document.getElementById("root")),Z()},82:function(e,t,n){}},[[133,1,2]]]);
//# sourceMappingURL=main.8f487468.chunk.js.map